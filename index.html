<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
</head>
<body>
    <script>
        window.fbAsyncInit = function() {
          FB.init({
            appId            : location.search.substr(1),
            autoLogAppEvents : true,
            xfbml            : true,
            version          : 'v15.0'
          });
        };
        
      </script>
      <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk/debug.js"></script>
          
    <h1>Facebook Long-lived User Access Token generator</h1>
    <p>Because for some reason this can't be handled exclusively server side without setting up 5 million things</p>
    <ol>
        <li><p>Set the appid in the query string and refresh the page. Example: <span id="example"></span></p></li>
        <button id="loginbutton"></button>
        <!--
        <li>Modify the login button as necessary <textarea id="loginbutton"><fb:login-button scope="public_profile,email" onlogin="getcode();"></fb:login-button></textarea></li>
        <li>Log in with that button: <div id="loginbutton"></div></li>
        -->
    </ol>
    
    <a href="https://developers.facebook.com/docs/pages/access-tokens">Docs (Get a Long-lived User Access Token)</a>
    <input type="text" id="app-secret" placeholder="App Secret" />
    
   

    <script>
        let request = `curl -i -X GET "https://graph.facebook.com/oauth/access_token?grant_type=fb_exchange_token&
                        client_id=APP-ID&
                        client_secret=APP-SECRET&
                        fb_exchange_token=SHORT-LIVED-USER-ACCESS-TOKEN"`;
        document.getElementById("example").innerText = window.location.origin + window.location.pathname.trimRight("/") + "?" + "app-id";

                        
        function getcode() {
            FB.login((response) => {

                FB.getLoginStatus(function(response) {
                    console.log(response);
                    if (response.status === 'connected') {
                        var accessToken = response.authResponse.accessToken;
                        request = request.replace("APP-ID", location.search.substr(1))
                                        .replace("APP-SECRET", document.getElementById("app-secret").value);
                        document.getElementById("code").innerText = request;

                    } 
                });
            })
        };
        document.getElementById("loginbutton").addEventListener("click", getcode);

    </script>
    <code id="code"></code>

</body>
</html>